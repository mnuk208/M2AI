<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>AI-Detect by MÂ²AI</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <script src="https://unpkg.com/@antv/g2plot@2.4.22/dist/g2plot.min.js"></script>
    <style>
      :root {
        --bg-light: #f3f4f6;
        --bg-dark: #111827;
        --text-light: #111827;
        --text-dark: #f3f4f6;
        --card-light: #ffffff;
        --card-dark: #1f2937;
        --accent: #2563eb;
        --error: #dc2626;
      }

      body {
        margin: 0;
        font-family: "Inter", sans-serif;
        background-color: var(--bg-light);
        color: var(--text-light);
        transition: background-color 0.4s, color 0.4s;
      }

      html.dark body {
        background-color: var(--bg-dark);
        color: var(--text-dark);
      }

      .container {
        max-width: 1000px;
        margin: 40px auto;
        background: var(--card-light);
        padding: 40px;
        border-radius: 12px;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      html.dark .container {
        background: var(--card-dark);
      }

      h1 {
        text-align: center;
        color: var(--accent);
      }

      .theme-toggle {
        position: absolute;
        top: 20px;
        right: 30px;
        cursor: pointer;
        background: transparent;
        border: 2px solid var(--accent);
        border-radius: 20px;
        padding: 6px 14px;
        color: var(--accent);
      }

      textarea {
        width: 100%;
        min-height: 150px;
        padding: 15px;
        font-size: 1rem;
        border-radius: 8px;
        border: 1px solid #ccc;
        overflow: auto;
      }

      .button-group {
        display: flex;
        justify-content: center;
        gap: 12px;
        margin-top: 15px;
        flex-wrap: wrap;
      }

      button {
        background-color: var(--accent);
        color: white;
        padding: 12px 25px;
        border: none;
        border-radius: 6px;
        font-size: 1rem;
        cursor: pointer;
      }

      input[type="file"] {
        background: none;
        color: inherit;
        border: none;
        font-family: inherit;
        padding: 0;
      }

      .spinner {
        display: none;
        margin: 15px auto;
        border: 6px solid #f3f3f3;
        border-top: 6px solid var(--accent);
        border-radius: 50%;
        width: 40px;
        height: 40px;
        animation: spin 0.9s linear infinite;
      }

      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      .gauge-section {
        display: none;
        justify-content: center;
        gap: 40px;
        margin-top: 30px;
        flex-wrap: wrap;
      }

      .gauge-block {
        text-align: center;
        width: 300px;
        height: 200px;
      }
    </style>
  </head>
  <body>
    <button id="theme-toggle" class="theme-toggle" onclick="toggleTheme()">
      ðŸŒ™
    </button>
    <div class="container">
      <h1>Let me Help You Detect AI Content</h1>
      <form method="post" onsubmit="handleAnalyze(event)">
        <textarea
          id="input_text"
          name="input_text"
          placeholder="Paste text here..."
        ></textarea>
        <div class="button-group">
          <button type="submit">Analyze Text</button>
          <button type="button" onclick="recalibrate()">Recalibrate</button>
          <input
            type="file"
            id="fileInput"
            accept=".txt,.doc,.docx,.pdf,.ppt,.pptx"
          />
        </div>
        <div class="spinner" id="spinner"></div>
      </form>
      <div class="gauge-section" id="gaugeSection">
        <div class="gauge-block" id="aiGauge"></div>
        <div class="gauge-block" id="humanGauge"></div>
      </div>
    </div>

    <script>
      const toggleBtn = document.getElementById("theme-toggle");
      const spinner = document.getElementById("spinner");
      const gaugeSection = document.getElementById("gaugeSection");
      const fileInput = document.getElementById("fileInput");

      function applySavedTheme() {
        const theme = localStorage.getItem("theme");
        const isDark = theme === "dark";
        document.documentElement.classList.toggle("dark", isDark);
        toggleBtn.textContent = isDark ? "ðŸŒ™" : "ðŸŒž";
      }

      function toggleTheme() {
        const isDark = document.documentElement.classList.toggle("dark");
        localStorage.setItem("theme", isDark ? "dark" : "light");
        toggleBtn.textContent = isDark ? "ðŸŒ™" : "ðŸŒž";
      }

      function showSpinner() {
        spinner.style.display = "block";
      }

      function hideSpinner() {
        spinner.style.display = "none";
      }

      function recalibrate() {
        document.getElementById("input_text").value = "";
        hideSpinner();
        gaugeSection.style.display = "none";
        fileInput.value = ""; // Reset file input label
      }

      window.onload = () => {
        applySavedTheme();
        initGauges();
      };

      fileInput.addEventListener("change", handleFileUpload);

      function handleFileUpload(event) {
        const file = event.target.files[0];
        if (!file) return;

        const reader = new FileReader();

        if (file.name.endsWith(".txt")) {
          reader.onload = () => {
            document.getElementById("input_text").value = reader.result;
          };
          reader.readAsText(file);
        } else {
          alert("Only .txt supported in this version.");
        }
      }

      let aiGaugePlot, humanGaugePlot;

      function initGauges() {
        aiGaugePlot = new G2Plot.Gauge("aiGauge", {
          percent: 0,
          range: { color: "#2563eb" },
          indicator: { pointer: { style: { stroke: "#2563eb" } }, pin: false },
          axis: { label: null, tickLine: null, subTickLine: null },
          statistic: {
            title: { content: "AI Likelihood" },
            content: { content: "0%" },
          },
        });

        humanGaugePlot = new G2Plot.Gauge("humanGauge", {
          percent: 0,
          range: { color: "#10b981" },
          indicator: { pointer: { style: { stroke: "#10b981" } }, pin: false },
          axis: { label: null, tickLine: null, subTickLine: null },
          statistic: {
            title: { content: "Human Likelihood" },
            content: { content: "0%" },
          },
        });

        aiGaugePlot.render();
        humanGaugePlot.render();
      }

      function updateGauges(aiPercent, humanPercent) {
        aiGaugePlot.update({
          percent: aiPercent / 100,
          statistic: { content: { content: `${aiPercent}%` } },
        });
        humanGaugePlot.update({
          percent: humanPercent / 100,
          statistic: { content: { content: `${humanPercent}%` } },
        });
      }

      function handleAnalyze(event) {
        event.preventDefault();
        showSpinner();

        const inputText = document.getElementById("input_text").value;
        if (!inputText.trim()) return hideSpinner();

        // Simulate backend result fetch
        setTimeout(() => {
          const aiScore = Math.floor(Math.random() * 100);
          const humanScore = 100 - aiScore;
          updateGauges(aiScore, humanScore);
          gaugeSection.style.display = "flex";
          hideSpinner();
        }, 1000);
      }
    </script>
  </body>
</html>
